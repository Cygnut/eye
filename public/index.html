<!DOCTYPE html>
<html>
<head>
	<script src="vendor/jquery-3.1.1.min.js"></script>
	<script src="js/EyeApi.js"></script>
	
	<link rel="shortcut icon" href="images/EyeIcon-64x64-Transparent.png" />
	<link rel="stylesheet" href="vendor/w3.css">
	
	<title>Eye</title>
	
	<meta charset="UTF-8">
	<meta name="description" content="Remote device administration and diagnostics.">
	<meta name="keywords" content="Remote Access, Administration, Diagnostics">
	<meta name="author" content="Cygnut">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
<style>
header img {
	margin: 10px;
	width: 50px;
	height: 50px;
	float: left;
}

article {
	padding: 5px 5px 5px 5px;
	margin: 95px 10px 45px 10px;
	
	border-width: 15px 15px 15px 15px;
	border-style: solid;
	border-color: white;
}

table, form input, p, h3, h4, h5 {
	margin-left: 10px;
}

/* Apps accordion styling */
button.accordion {
    background-color: #eee;
    color: #444;
    cursor: pointer;
    padding: 18px;
    width: 100%;
    text-align: left;
    border: none;
    outline: none;
    transition: 0.4s;
}

button.accordion.active, button.accordion:hover {
    background-color: #ddd;
}

/* Accordion panel style when hidden */
div.panel {
    padding: 0 18px;
    background-color: white;
    display: none;
}

/* Accordion panel style override when shown */
div.panel.show {
    display: block;
}

</style>
<script>

const ignoredMaintenanceFields = [ 'repo' ];

function updateMaintenance()
{
	EyeApi.getMaintenance(function(err, data) {
		
		var table = $('#maintenance-table');
		
		table.empty();
		table.append("<tr><th>Name</th><th>Value</th></tr>");
		
		if (err)
		{
			// TODO: Display errors.
		}
		else
		{
			$.each(data, function(name, value) {
				if (ignoredMaintenanceFields.indexOf(name.toLowerCase()) <= -1)
					table.append('<tr><td>' + name + '</td><td>' + value + '</td></tr>');
			});
		}
		
		setTimeout(updateMaintenance, 3000);
	});
}

function updateApps()
{
	EyeApi.getApps(function(err, data) {
		
		if (err)
		{
			// TODO: Display errors.
		}
		else
		{
/*
		// We should be building the html for these accordions on the serverside, or using Angular?
			$.each(app, function(name, value) {
			
<button class="accordion">Section 1</button>
<div class="panel">
  <p>Lorem ipsum...</p>
</div>

			
			});
*/
		}
	});
}

$(document).ready(function() {
	
	updateMaintenance();
	
	updateApps();
	
});

function deleteInstalledApps()
{
	EyeApi.deleteInstalledApps(function(err, data) {
		if (err)
		{
			// TODO: Display errors.
		}
	});
}

</script>
</head>
<body>

<header class="header w3-top w3-container w3-blue">
	<img src="images/EyeIcon-100x100-Transparent.png" />
	<h1>Eye</h1>
</header>

<article>

<section id="maintenance">
<h2>Maintenance Configuration</h2>
<table id="maintenance-table" class="w3-table-all"></table>
<section>

</section id="apps">
</section>

</section id="utilities">
<h2>Utilities</h2>
<form>
	<h5>Delete all apps deployed by eye? They will be redeployed at the next interval.</h5>
	<input type="button" class="w3-btn" onclick="deleteInstalledApps()" value="Delete Installed Apps"></input>
</form>
</section>

</article>

</body>
</html>
